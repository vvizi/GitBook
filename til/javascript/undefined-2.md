---
description: JS에서 비동기 처리와 동시성을 가능하게 하는 런타임 매커니즘
---

# 이벤트 루프

JS는 싱글 스레드 언어로 한 번에 하나의 작업만 처리할 수 있다.

이벤트 루프로 비동기 코드를 사용할 수 있어 여러 작업이 진행되는 것 처럼 보일 수 있다.



### 구성 요소

* Call Stack
  * **현재 실행 중인 동기 함수**들이 쌓이는 공간
  * 함수가 호출되면 스택에 `push`되고 실행이 끝나면 `pop`된다.
* Web API (브라우저 환경)
  * 비동기 작업은 브라우저의 Web API 가 처리한다 (`setTimeout`, `DOM 이벤트`, `fetch`)
* Task Queue
  * 비동기 작업이 완료되면 해당 **콜백 함수가 대기**한다.
  * 이벤트 루프는 **콜 스택이 비어있을 때**만 **큐에 있는 콜백을 실행**한다.
* Microtask Queue
  * `Promise`, `queueMicrotask`, `MutationObserver`의 콜백
  * Task Queue보다 우선순위가 높다.
* Event Loop
  * 콜 스택이 비어있으면 태스크 큐와 마이크로 태스크 큐를 확인하여 콜백을 실행한다.
  * 마이크로 태스크 큐가 완전히 비워질 때까지 다른 작업을 실행하지 않는다.



### 동작 순서

1. **콜 스택**이 비어있으면 이벤트 루프가 실행됨.
2. **마이크로 태스크 큐**의 모든 작업을 우선 실행함.
3. 마이크로 태스크 큐가 비워지면 **태스크 큐**에서 콜백을 하나씩 가져와 실행함.
4. 해당 작업이 끝나면 다시 **마이크로 태스크 큐**를 확인함.
5. 반복



### 요약

* **JavaScript는 싱글 스레드**이지만, 이벤트 루프를 통해 비동기 처리를 관리한다.
* 이벤트 루프는 콜 스택이 비어있을 때 **Task Queue**와 **Microtask Queue**의 작업을 실행한다.
* **Microtask Queue**(`Promise`, `async/await`, `queueMicrotask`)는 **Task Queue**(`setTimeout`, `setInterval`, `I/O`)보다 **우선순위가 높다.**



